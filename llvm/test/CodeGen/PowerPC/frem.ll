; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -mtriple=powerpc64le -mcpu=pwr9 < %s | FileCheck %s

define float @frem32(float %a, float %b) {
; CHECK-LABEL: frem32:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    xsresp 0, 2
; CHECK-NEXT:    fmr 4, 1
; CHECK-NEXT:    xsmulsp 3, 1, 0
; CHECK-NEXT:    xsnmsubasp 4, 2, 3
; CHECK-NEXT:    xsmaddasp 3, 0, 4
; CHECK-NEXT:    xsrdpiz 0, 3
; CHECK-NEXT:    xsnmsubasp 1, 0, 2
; CHECK-NEXT:    blr
entry:
  %rem = frem fast float %a, %b
  ret float %rem
}

define double @frem64(double %a, double %b) {
; CHECK-LABEL: frem64:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    vspltisw 2, -1
; CHECK-NEXT:    xsredp 0, 2
; CHECK-NEXT:    fmr 4, 1
; CHECK-NEXT:    xvcvsxwdp 3, 34
; CHECK-NEXT:    xsmaddadp 3, 2, 0
; CHECK-NEXT:    xsnmsubadp 0, 0, 3
; CHECK-NEXT:    xsmuldp 3, 1, 0
; CHECK-NEXT:    xsnmsubadp 4, 2, 3
; CHECK-NEXT:    xsmaddadp 3, 0, 4
; CHECK-NEXT:    xsrdpiz 0, 3
; CHECK-NEXT:    xsnmsubadp 1, 0, 2
; CHECK-NEXT:    blr
entry:
  %rem = frem fast double %a, %b
  ret double %rem
}

define <4 x float> @frem4x32(<4 x float> %a, <4 x float> %b) {
; CHECK-LABEL: frem4x32:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    xvresp 0, 35
; CHECK-NEXT:    vmr 4, 2
; CHECK-NEXT:    xvmulsp 1, 34, 0
; CHECK-NEXT:    xvnmsubasp 36, 35, 1
; CHECK-NEXT:    xvmaddasp 1, 0, 36
; CHECK-NEXT:    xvrspiz 0, 1
; CHECK-NEXT:    xvnmsubasp 34, 0, 35
; CHECK-NEXT:    blr
entry:
  %rem = frem fast <4 x float> %a, %b
  ret <4 x float> %rem
}

define <2 x double> @frem2x64(<2 x double> %a, <2 x double> %b) {
; CHECK-LABEL: frem2x64:
; CHECK:       # %bb.0: # %entry
; CHECK-NEXT:    addis 3, 2, .LCPI3_0@toc@ha
; CHECK-NEXT:    xvredp 0, 35
; CHECK-NEXT:    vmr 4, 2
; CHECK-NEXT:    addi 3, 3, .LCPI3_0@toc@l
; CHECK-NEXT:    lxv 1, 0(3)
; CHECK-NEXT:    xvmaddadp 1, 35, 0
; CHECK-NEXT:    xvnmsubadp 0, 0, 1
; CHECK-NEXT:    xvmuldp 1, 34, 0
; CHECK-NEXT:    xvnmsubadp 36, 35, 1
; CHECK-NEXT:    xvmaddadp 1, 0, 36
; CHECK-NEXT:    xvrdpiz 0, 1
; CHECK-NEXT:    xvnmsubadp 34, 0, 35
; CHECK-NEXT:    blr
entry:
  %rem = frem fast <2 x double> %a, %b
  ret <2 x double> %rem
}
